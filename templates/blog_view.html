{% extends 'base.html' %}
<!-- for comments -->
{% load crispy_forms_tags %}

{% block banner %}
<h1 class="banner-h1 blog-view-h1">{{ blog.title }}</h1>
<!-- blog image -->
<!-- placeholder img statement -->
{% if "placeholder" in blog.main_image.url %}
    <!-- placeholder image in media dir -->
    <img class="card-img" src="media/images/placeholder-img.jpg" alt="blog image">
{% else %}
    <!-- database image in Cloudinary -->
    <img class="card-img" src=" {{ blog.main_image.url }}" alt="blog image">
{% endif %}
<!-- <img src="media/images/placeholder-img.jpg" alt="blog image"> -->
{% endblock banner %}

{% block content %}

<div class="blog-view">

    <!-- alert messages -->

    <!-- blog content/layout -->
    <div>
        <p class="text-muted">
            {{ blog.created_date }}
        </p>
    </div>
    <!-- blog content -->
    <div>
        {{ blog.content | safe }}
    </div>

    <!-- the like/comment icon whether user is logged in or not -->
    <div class="text-muted">
        <i class="fa-solid fa-hands-clapping"></i>
        {{ blog.number_of_likes }} 
    </div>
    <hr>
    <!-- displaying approved comments -->
    <div class="text-muted">
        <i class="fa-solid fa-comments"></i>
        {{ blog.number_of_comments }}
        <h3>Comments:</h3>
        <div>
            {% for comment in comments %}
            <div>
                <p>
                    {{ comment.name }}
                    {{ comment.created_date }}
                    wrote:
                </p>
                {{ comment.body | linebreaks}}
            </div>
            {% endfor %}
        </div>
    </div>
    {% if commented %}
        <div class="alert alert-success" role="alert">
            Comment posted
        </div>
    {% else %}
    {% if user.is_authenticated %}
    <div class="text-muted">
        <h4>Add comment:</h4>
        <form method="post">
            <!-- our form and the program to format it -->
            {{ comment_form | crispy }}
            <!-- prtecting against malicious users -->
            {% csrf_token %}
            <button class="allauth-form-btn" type="submit">Post as {{ user.username }}</button>
        </form>
    </div>
    {% endif %}
    {% endif %}
</div>

<!-- awaiting approval message/leave a comment form -->

{% endblock content %}